let WhatsAlexa = require('../main/events');
let {MessageType, Mimetype} = require('@adiwajshing/baileys');
let Config = require('../main/config');
let fs = require('fs');
let got = require('got');
let FormData = require('form-data');
let stream = require('stream');
let {promisify} = require('util');
let pipeline = promisify(stream.pipeline);
let Language = require('../language');
let Lang = Language.getString('removebg');

if (Config.WORKTYPE == 'private') {

    WhatsAlexa.addCommand({pattern: 'rbg ?(.*)', fromMe: true, desc: Lang.REMOVEBG_DESC}, (async (message, match) => {    

    var _0x5b885a=_0x1e76;(function(_0x27d360,_0x388f55){var _0x49f2d5=_0x1e76,_0x42f4af=_0x27d360();while(!![]){try{var _0x4cc95f=-parseInt(_0x49f2d5(0x1be))/0x1+-parseInt(_0x49f2d5(0x1c5))/0x2*(-parseInt(_0x49f2d5(0x1c7))/0x3)+parseInt(_0x49f2d5(0x1c6))/0x4*(-parseInt(_0x49f2d5(0x1cf))/0x5)+parseInt(_0x49f2d5(0x1df))/0x6*(parseInt(_0x49f2d5(0x1c8))/0x7)+parseInt(_0x49f2d5(0x1db))/0x8*(parseInt(_0x49f2d5(0x1d3))/0x9)+parseInt(_0x49f2d5(0x1ca))/0xa*(parseInt(_0x49f2d5(0x1cb))/0xb)+parseInt(_0x49f2d5(0x1da))/0xc*(-parseInt(_0x49f2d5(0x1d1))/0xd);if(_0x4cc95f===_0x388f55)break;else _0x42f4af['push'](_0x42f4af['shift']());}catch(_0x4a8fb5){_0x42f4af['push'](_0x42f4af['shift']());}}}(_0x3da8,0x648a9));if(message[_0x5b885a(0x1d8)]===![]||message[_0x5b885a(0x1d8)][_0x5b885a(0x1bf)]===![])return await message[_0x5b885a(0x1c2)][_0x5b885a(0x1c3)](message['jid'],Lang[_0x5b885a(0x1e1)],MessageType['text']);if(Config['RBG_API_KEY']===![])return await message[_0x5b885a(0x1c2)][_0x5b885a(0x1c3)](message[_0x5b885a(0x1c0)],Lang['NO_API_KEY'],MessageType[_0x5b885a(0x1dc)]);var load=await message[_0x5b885a(0x1c9)](Lang['RBGING']),location=await message[_0x5b885a(0x1c2)][_0x5b885a(0x1d6)]({'key':{'remoteJid':message[_0x5b885a(0x1d8)]['jid'],'id':message[_0x5b885a(0x1d8)]['id']},'message':message[_0x5b885a(0x1d8)][_0x5b885a(0x1e0)][_0x5b885a(0x1d5)]}),form=new FormData();form['append'](_0x5b885a(0x1c4),fs[_0x5b885a(0x1d9)](location)),form[_0x5b885a(0x1d7)](_0x5b885a(0x1c1),_0x5b885a(0x1ce));var rbg=await got['stream'][_0x5b885a(0x1de)](_0x5b885a(0x1dd),{'body':form,'headers':{'X-Api-Key':Config[_0x5b885a(0x1cd)]}});function _0x1e76(_0x5d0570,_0x1eb5ee){var _0x3da886=_0x3da8();return _0x1e76=function(_0x1e76de,_0x245edb){_0x1e76de=_0x1e76de-0x1bd;var _0x3d87ba=_0x3da886[_0x1e76de];return _0x3d87ba;},_0x1e76(_0x5d0570,_0x1eb5ee);}function _0x3da8(){var _0x237e67=['png','561139WGFKxI','image','jid','size','client','sendMessage','image_file','148748AvJFln','15812imHsYa','18gVwiwG','58723GPjQuh','reply','500230SkPiCK','132KvJdlb','readFileSync','RBG_API_KEY','auto','465dUxnTh','delete','2550327JKgjBJ','rbg.png','414TkRlnu','document','quotedMessage','downloadAndSaveMediaMessage','append','reply_message','createReadStream','48JIIhyO','89864WCsPam','text','https://api.remove.bg/v1.0/removebg','post','402XvXctC','data','NEED_PHOTO'];_0x3da8=function(){return _0x237e67;};return _0x3da8();}await pipeline(rbg,fs['createWriteStream'](_0x5b885a(0x1d2))),await message['client'][_0x5b885a(0x1c3)](message['jid'],fs[_0x5b885a(0x1cc)]('rbg.png'),MessageType[_0x5b885a(0x1d4)],{'filename':'WhatsAsena.png','mimetype':Mimetype[_0x5b885a(0x1bd)]}),await load[_0x5b885a(0x1d0)]();
    }));
}
else if (Config.WORKTYPE == 'public') {

    WhatsAlexa.addCommand({pattern: 'rbg ?(.*)', fromMe: false, desc: Lang.REMOVEBG_DESC}, (async (message, match) => {    

    var _0x5b885a=_0x1e76;(function(_0x27d360,_0x388f55){var _0x49f2d5=_0x1e76,_0x42f4af=_0x27d360();while(!![]){try{var _0x4cc95f=-parseInt(_0x49f2d5(0x1be))/0x1+-parseInt(_0x49f2d5(0x1c5))/0x2*(-parseInt(_0x49f2d5(0x1c7))/0x3)+parseInt(_0x49f2d5(0x1c6))/0x4*(-parseInt(_0x49f2d5(0x1cf))/0x5)+parseInt(_0x49f2d5(0x1df))/0x6*(parseInt(_0x49f2d5(0x1c8))/0x7)+parseInt(_0x49f2d5(0x1db))/0x8*(parseInt(_0x49f2d5(0x1d3))/0x9)+parseInt(_0x49f2d5(0x1ca))/0xa*(parseInt(_0x49f2d5(0x1cb))/0xb)+parseInt(_0x49f2d5(0x1da))/0xc*(-parseInt(_0x49f2d5(0x1d1))/0xd);if(_0x4cc95f===_0x388f55)break;else _0x42f4af['push'](_0x42f4af['shift']());}catch(_0x4a8fb5){_0x42f4af['push'](_0x42f4af['shift']());}}}(_0x3da8,0x648a9));if(message[_0x5b885a(0x1d8)]===![]||message[_0x5b885a(0x1d8)][_0x5b885a(0x1bf)]===![])return await message[_0x5b885a(0x1c2)][_0x5b885a(0x1c3)](message['jid'],Lang[_0x5b885a(0x1e1)],MessageType['text']);if(Config['RBG_API_KEY']===![])return await message[_0x5b885a(0x1c2)][_0x5b885a(0x1c3)](message[_0x5b885a(0x1c0)],Lang['NO_API_KEY'],MessageType[_0x5b885a(0x1dc)]);var load=await message[_0x5b885a(0x1c9)](Lang['RBGING']),location=await message[_0x5b885a(0x1c2)][_0x5b885a(0x1d6)]({'key':{'remoteJid':message[_0x5b885a(0x1d8)]['jid'],'id':message[_0x5b885a(0x1d8)]['id']},'message':message[_0x5b885a(0x1d8)][_0x5b885a(0x1e0)][_0x5b885a(0x1d5)]}),form=new FormData();form['append'](_0x5b885a(0x1c4),fs[_0x5b885a(0x1d9)](location)),form[_0x5b885a(0x1d7)](_0x5b885a(0x1c1),_0x5b885a(0x1ce));var rbg=await got['stream'][_0x5b885a(0x1de)](_0x5b885a(0x1dd),{'body':form,'headers':{'X-Api-Key':Config[_0x5b885a(0x1cd)]}});function _0x1e76(_0x5d0570,_0x1eb5ee){var _0x3da886=_0x3da8();return _0x1e76=function(_0x1e76de,_0x245edb){_0x1e76de=_0x1e76de-0x1bd;var _0x3d87ba=_0x3da886[_0x1e76de];return _0x3d87ba;},_0x1e76(_0x5d0570,_0x1eb5ee);}function _0x3da8(){var _0x237e67=['png','561139WGFKxI','image','jid','size','client','sendMessage','image_file','148748AvJFln','15812imHsYa','18gVwiwG','58723GPjQuh','reply','500230SkPiCK','132KvJdlb','readFileSync','RBG_API_KEY','auto','465dUxnTh','delete','2550327JKgjBJ','rbg.png','414TkRlnu','document','quotedMessage','downloadAndSaveMediaMessage','append','reply_message','createReadStream','48JIIhyO','89864WCsPam','text','https://api.remove.bg/v1.0/removebg','post','402XvXctC','data','NEED_PHOTO'];_0x3da8=function(){return _0x237e67;};return _0x3da8();}await pipeline(rbg,fs['createWriteStream'](_0x5b885a(0x1d2))),await message['client'][_0x5b885a(0x1c3)](message['jid'],fs[_0x5b885a(0x1cc)]('rbg.png'),MessageType[_0x5b885a(0x1d4)],{'filename':'WhatsAsena.png','mimetype':Mimetype[_0x5b885a(0x1bd)]}),await load[_0x5b885a(0x1d0)]();
    }));
    
}
